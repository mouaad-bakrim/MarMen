{% load static %}

<div id="kt_app_header" class="app-header" data-kt-sticky="true" data-kt-sticky-activate="{default: true, lg: true}"
     data-kt-sticky-name="app-header-minimize" data-kt-sticky-offset="{default: '200px', lg: '0'}"
     data-kt-sticky-animation="false">
    <!--begin::Header container-->
    <div class="app-container container-fluid d-flex align-items-stretch justify-content-between"
         id="kt_app_header_container" style="background-color: #f7f7f7; height: 65px;">
        <!--begin::Sidebar mobile toggle-->
        <div class="d-flex align-items-center d-lg-none ms-n3 me-1 me-md-2" title="Show sidebar menu">
            <div class="btn btn-icon btn-active-color-primary w-35px h-35px" id="kt_app_sidebar_mobile_toggle">
                <i class="ki-duotone ki-abstract-14 fs-2 fs-md-1">
                    <span class="path1"></span>
                    <span class="path2"></span>
                </i>
            </div>
        </div>
        <!--end::Sidebar mobile toggle-->
        <!--begin::Mobile logo-->
        <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0">

            <a href="" class="d-lg-none">
                <img alt="Logo" src="{% static 'assets/logo/mar.png' %}" class="h-30px"/>
            </a>

        </div>

        <!--end::Mobile logo-->
        <!--begin::Header wrapper-->
        <div class="d-flex align-items-stretch justify-content-between flex-lg-grow-1" id="kt_app_header_wrapper">
            <!--begin::Menu wrapper-->
            <div class="app-header-menu app-header-mobile-drawer align-items-stretch" data-kt-drawer="true"
                 data-kt-drawer-name="app-header-menu" data-kt-drawer-activate="{default: true, lg: false}"
                 data-kt-drawer-overlay="true" data-kt-drawer-width="250px" data-kt-drawer-direction="end"
                 data-kt-drawer-toggle="#kt_app_header_menu_toggle" data-kt-swapper="true"
                 data-kt-swapper-mode="{default: 'append', lg: 'prepend'}"
                 data-kt-swapper-parent="{default: '#kt_app_body', lg: '#kt_app_header_wrapper'}">
                <!--begin::Menu-->
                <div class="menu menu-rounded menu-column menu-lg-row my-5 my-lg-0 align-items-stretch fw-semibold px-2 px-lg-0"
                     id="kt_app_header_menu" data-kt-menu="true">
                    <!--begin:Menu item-->

                    <div data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-placement="bottom-start"
                         class="menu-item here show menu-here-bg menu-lg-down-accordion me-0 me-lg-2">
<span class="menu-link">
    {% if user_sites %}
        <span class="menu-title">
            {% if user_sites|length == 1 %}
            <!-- Si l'utilisateur a un seul site, on l'affiche -->
                {{ user_sites.0.nom }}
            {% else %}
            <!-- Si l'utilisateur a plusieurs sites, on affiche 'Administration' -->
                Administration
            {% endif %}
        </span>
    {% else %}
    <!-- Si l'utilisateur n'a pas de site, on affiche 'Administration' -->
        <span class="menu-title">Administration</span>
    {% endif %}
    <span class="menu-arrow d-lg-none"></span>
</span>


                        <!--end:Menu link-->
                        <!--begin:Menu sub-->
                        <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown p-0 w-100 w-lg-850px">
                            <!--begin:Dashboards menu-->
                            <div class="menu-state-bg menu-extended overflow-hidden overflow-lg-visible"
                                 data-kt-menu-dismiss="true">
                                <!--begin:Row-->

                            </div>
                            <!--end:Dashboards menu-->
                        </div>
                        <!--end:Menu sub-->
                    </div>


                </div>
                <!--end::Menu-->
            </div>

            <!--end::Menu wrapper-->
            <!--begin::Navbar-->
            <div class="app-navbar flex-shrink-0">
                <!--begin::Search-->
                <div class="app-navbar-item align-items-stretch ms-1 ms-md-4">
                    <!--begin::Search-->
                    <div id="kt_header_search" class="header-search d-flex align-items-stretch"
                         data-kt-search-keypress="true" data-kt-search-min-length="2" data-kt-search-enter="enter"
                         data-kt-search-layout="menu" data-kt-menu-trigger="auto" data-kt-menu-overflow="false"
                         data-kt-menu-permanent="true" data-kt-menu-placement="bottom-end">
                        <!--begin::Search toggle-->

                        <!--end::Search toggle-->
                        <!--begin::Menu-->
                        <div data-kt-search-element="content"
                             class="menu menu-sub menu-sub-dropdown p-7 w-325px w-md-375px">
                            <!--begin::Wrapper-->
                            <div data-kt-search-element="wrapper">
                                <!--begin::Form-->
                                <form data-kt-search-element="form" class="w-100 position-relative mb-3"
                                      autocomplete="off">
                                    <!--begin::Icon-->
                                    <i class="ki-duotone ki-magnifier fs-2 text-gray-500 position-absolute top-50 translate-middle-y ms-0">
                                        <span class="path1"></span>
                                        <span class="path2"></span>
                                    </i>
                                    <!--end::Icon-->
                                    <!--begin::Input-->
                                    <input type="text" class="search-input form-control form-control-flush ps-10"
                                           name="search" value="" placeholder="Search..."
                                           data-kt-search-element="input"/>
                                    <!--end::Input-->
                                    <!--begin::Spinner-->
                                    <span class="search-spinner position-absolute top-50 end-0 translate-middle-y lh-0 d-none me-1"
                                          data-kt-search-element="spinner">
														<span class="spinner-border h-15px w-15px align-middle text-gray-500"></span>
													</span>
                                    <!--end::Spinner-->
                                    <!--begin::Reset-->
                                    <span class="search-reset btn btn-flush btn-active-color-primary position-absolute top-50 end-0 translate-middle-y lh-0 d-none"
                                          data-kt-search-element="clear">
														<i class="ki-duotone ki-cross fs-2 fs-lg-1 me-0">
															<span class="path1"></span>
															<span class="path2"></span>
														</i>
													</span>
                                    <!--end::Reset-->
                                    <!--begin::Toolbar-->
                                    <div class="position-absolute top-50 end-0 translate-middle-y"
                                         data-kt-search-element="toolbar">
                                        <!--begin::Preferences toggle-->
                                        <div data-kt-search-element="preferences-show"
                                             class="btn btn-icon w-20px btn-sm btn-active-color-primary me-1"
                                             data-bs-toggle="tooltip" title="Show search preferences">
                                            <i class="ki-duotone ki-setting-2 fs-2">
                                                <span class="path1"></span>
                                                <span class="path2"></span>
                                            </i>
                                        </div>
                                        <!--end::Preferences toggle-->
                                        <!--begin::Advanced search toggle-->
                                        <div data-kt-search-element="advanced-options-form-show"
                                             class="btn btn-icon w-20px btn-sm btn-active-color-primary"
                                             data-bs-toggle="tooltip" title="Show more search options">
                                            <i class="ki-duotone ki-down fs-2"></i>
                                        </div>
                                        <!--end::Advanced search toggle-->
                                    </div>
                                    <!--end::Toolbar-->
                                </form>
                                <!--end::Form-->
                                <!--begin::Separator-->
                                <div class="separator border-gray-200 mb-6"></div>
                                <!--end::Separator-->


                            </div>

                        </div>
                        <!--end::Menu-->
                    </div>
                    <!--end::Search-->
                </div>


<!--begin::Navbar-->
				<div class="app-navbar flex-grow-1 justify-content-end" id="kt_app_header_navbar">
					<div class="app-navbar-item d-flex align-items-stretch flex-lg-grow-1">

				</div>


					{% comment %} <!--begin::Chat-->
					<div class="app-navbar-item ms-2 ms-lg-6">
						<!--begin::Menu wrapper-->
						<div class="btn btn-icon btn-custom btn-color-gray-600 btn-active-color-primary w-35px h-35px w-md-40px h-md-40px position-relative" id="kt_drawer_chat_toggle">
							<i class="ki-outline ki-notification-on fs-1"></i>
							<span class="position-absolute top-0 start-100 translate-middle  badge badge-circle badge-danger w-15px h-15px ms-n4 mt-3">5</span>
						</div>
						<!--end::Menu wrapper-->
					</div>
					<!--end::Chat--> {% endcomment %}


					<div class="app-navbar-item ms-2 ms-lg-6">
						<div class="btn btn-icon btn-custom btn-color-gray-600 btn-active-color-primary w-35px h-35px w-md-40px h-md-40px position-relative" data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
							<i class="ki-outline ki-notification-on fs-1"></i>
							{% with nb_unread_notifications=user.unread_notifications_count %}
							{% if nb_unread_notifications %}
							<span class="position-absolute top-0 start-100 translate-middle  badge badge-circle badge-danger w-15px h-15px ms-n4 mt-3">{{ user.unread_notifications_count }}</span>
							{% endif %}
							{% endwith %}
						</div>

						<div class="menu menu-sub menu-sub-dropdown menu-column w-350px w-lg-375px" data-kt-menu="true" id="kt_menu_notifications">
							<div class="d-flex flex-column bgi-no-repeat rounded-top bg-primary" style="background-image:url('/metronic8/demo39/assets/media/misc/menu-header-bg.jpg')">
								<h3 class="text-white fw-semibold px-9 mt-6 mb-6">
									Notifications
									{% comment %} <span class="fs-8 opacity-75 ps-3">24 reports</span> {% endcomment %}
								</h3>
							</div>

							<div class="scroll-y mh-325px my-5 px-2">
								{% for notification in user.get_last_notificaitons %}
								<a class="d-flex flex-stack py-4 bg-hover-light-primary px-6"
									href="{% url 'base:notification_link' notification.pk %}"

									>
									<div class="d-flex align-items-center">
										{% comment %} <div class="symbol symbol-35px me-4">
											<span class="symbol-label bg-light-primary">
												<i class="ki-outline ki-abstract-28 fs-2 text-primary"></i>
											</span>
										</div> {% endcomment %}
										<div class="mb-0 me-2">
											<span class="fs-6  text-hover-primary
											{% if not notification.read_at %}fw-bolder text-gray-700{% else %} text-gray-600 fw-bold{% endif %}">
												{{ notification.title }}
											</span>
											<div class="text-gray-500 fs-7 {% if not notification.read_at %}fw-bolder text-gray-700 {% endif %} ">
												{{ notification.message }}
											</div>
										</div>
									</div>
									<span class="badge {% if notification.read_at %}badge-light{% else %}badge-primary fw-bolder{% endif %}
									fs-8">{{ notification.short_timesince }}</span>
								</a>
								{% empty %}
								<div class="d-flex flex-stack py-4 px-6 text-center">
									<span class="fs-6 fw-bolder text-muted text-center">
										Aucune notification
									</span>
								</div>
								{% endfor %}
							</div>

							<a class="py-3 text-center border-top bg-hover-light" href="">
								<span  class="btn btn-color-gray-600 btn-active-color-primary">
									Tout voir
									<i class="ki-outline ki-arrow-right fs-5"></i>
								</span>
							</a>
						</div>
					</div>




					<!--begin::User menu-->
					<div class="app-navbar-item ms-1 ms-md-4 me-2 me-md-8" id="kt_header_user_menu_toggle">
						<!--begin::Menu wrapper-->
						<div class="cursor-pointer symbol symbol-35px" data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
							<img src="{% static 'assets/media/avatars/blank.png' %}" class="rounded-3" alt="user" />
						</div>
						<!--begin::User account menu-->
						<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-color fw-semibold py-4 fs-6 w-275px" data-kt-menu="true">
							<!--begin::Menu item-->
							<div class="menu-item px-3">
								<div class="menu-content d-flex align-items-center px-5">
									<!--begin::Avatar-->
									{% comment %} <div class="symbol symbol-50px me-5">
										<img alt="Logo" src="{% static static 'assets/media/avatars/blank.png' %}" />
									</div> {% endcomment %}
									<!--end::Avatar-->
									<!--begin::Username-->
									<div class="d-flex flex-column">
										<div class="fw-bold d-flex align-items-center fs-5">{{user.get_full_name}}
										</div>
										<a href="#" class="fw-semibold text-muted text-hover-primary fs-7">{{user.email}}</a>
									</div>
									<!--end::Username-->
								</div>
							</div>
							<!--end::Menu item-->
							<div class="separator my-2"></div>
							<!--begin::Menu item-->
							{% if user.is_staff %}
							<div class="menu-item px-5">
								<a href="/admin/" class="menu-link px-5">Accès Admin</a>
							</div>
							<!--begin::Menu separator-->
							<div class="separator my-2"></div>
							<!--end::Menu separator-->
							{% endif%}

							<!--begin::Menu separator-->
							<div class="menu-item px-5">
								<a href="" class="menu-link px-5">Mon compte</a>
							</div>
							<!--end::Menu separator-->

							<!--begin::Menu item-->
							<div class="menu-item px-5 my-1">
								<a href="" class="menu-link px-5">Sécurité et connexion</a>
							</div>
							<!--end::Menu item-->

							<!--begin::Menu item-->
							<div class="menu-item px-5">
								<a href="" class="menu-link px-5">Se déconnecter</a>
							</div>
							<!--end::Menu item-->
						</div>
						<!--end::User account menu-->
						<!--end::Menu wrapper-->
					</div>

					<!--end::User menu-->

				</div>
				<!--end::Navbar-->
			</div>
			<!--end::Header main-->

		</div>
		</div>
		</div>